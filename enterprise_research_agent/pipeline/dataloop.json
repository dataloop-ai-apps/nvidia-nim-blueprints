{
  "name": "nvidia-aiq-enterprise-research-bp",
  "displayName": "AI Agent for Enterprise Research",
  "description": "Enterprise research agent pipeline replicated from NVIDIA AIQ Research Assistant Blueprint. Agent orchestrates RAG-first search with LLM-as-judge and web search fallback in a Plan-Execute-Reflect loop, then NIM Llama 3.3 70B generates the final report.",
  "version": "0.0.45",
  "scope": "public",
  "codebase": {
    "type": "item"
  },
  "attributes": {
    "Hub": ["Nvidia", "Dataloop"],
    "Category": ["Pipeline", "Blueprint"],
    "Pipeline Type": "GenAI",
    "Provider": "NVIDIA",
    "Developed By": "Dataloop",
    "Media Type": ["Text"]
  },
  "dependencies": [
    { "name": "nvidia-aiq-enterprise-research" },
    { "name": "nim-llama-3-3-70b-instruct" },
    { "name": "nim-rag-bp" }
  ],
  "variables": {
    "report_writer_model__model": "nim-llama-3-3-70b-instruct.models.nim-llama-3-3-70b-instruct"
  },
  "components": {
    "pipelineTemplates": [
      {
        "name": "AI Agent for Enterprise Research",
        "description": "Agent -> Research (RAG-first + Web fallback, cycle) -> NIM Llama 3.3 Report Generation",
        "connections": [
          {
            "src": { "nodeId": "node-init", "portId": "port-init-out" },
            "tgt": { "nodeId": "node-agent", "portId": "port-agent-in" },
            "condition": "{}"
          },
          {
            "src": { "nodeId": "node-agent", "portId": "port-agent-out" },
            "tgt": { "nodeId": "node-research", "portId": "port-research-in" },
            "condition": "{}",
            "action": "research"
          },
          {
            "src": { "nodeId": "node-research", "portId": "port-research-out" },
            "tgt": { "nodeId": "node-agent", "portId": "port-agent-in" },
            "condition": "{}"
          },
          {
            "src": { "nodeId": "node-agent", "portId": "port-agent-out" },
            "tgt": { "nodeId": "node-llama", "portId": "port-llama-in" },
            "condition": "{}",
            "action": "generate_report"
          }
        ],
        "startNodes": [
          {
            "nodeId": "node-init",
            "type": "root",
            "id": "start-node-1"
          }
        ],
        "nodes": [
          {
            "id": "node-init",
            "inputs": [
              {
                "portId": "port-init-in",
                "nodeId": "port-init-in",
                "type": "Item",
                "name": "item",
                "displayName": "item",
                "io": "input"
              },
              {
                "portId": "port-init-rag-pipeline",
                "nodeId": "port-init-rag-pipeline",
                "type": "String",
                "name": "rag_pipeline_id",
                "displayName": "RAG Pipeline ID",
                "variableName": "rag_pipeline_id",
                "io": "input"
              }
            ],
            "outputs": [
              {
                "portId": "port-init-out",
                "nodeId": "port-init-out",
                "type": "Item",
                "name": "item",
                "displayName": "item",
                "io": "output"
              }
            ],
            "name": "Init",
            "type": "custom",
            "namespace": {
              "functionName": "init_research",
              "serviceName": "enterprise-research-compute",
              "moduleName": "enterprise-research-module",
              "packageName": "nvidia-aiq-enterprise-research"
            },
            "appName": "NVIDIA AIQ Enterprise Research Agent",
            "dpkName": "nvidia-aiq-enterprise-research",
            "metadata": {
              "position": { "x": 9600, "y": 10274, "z": 0 },
              "componentGroupName": "NVIDIA AIQ Enterprise Research",
              "repeatable": true,
              "pipelineNodeName": "aiq-init-node"
            }
          },
          {
            "id": "node-agent",
            "inputs": [
              {
                "portId": "port-agent-in",
                "nodeId": "port-agent-in",
                "type": "Item",
                "name": "item",
                "displayName": "item",
                "io": "input"
              }
            ],
            "outputs": [
              {
                "portId": "port-agent-out",
                "nodeId": "port-agent-out",
                "type": "Item",
                "name": "item",
                "displayName": "item",
                "actions": ["research", "generate_report"],
                "io": "output"
              }
            ],
            "name": "NVIDIA AIQ Agent",
            "type": "custom",
            "namespace": {
              "functionName": "run_agent",
              "serviceName": "enterprise-research-compute",
              "moduleName": "enterprise-research-module",
              "packageName": "nvidia-aiq-enterprise-research"
            },
            "appName": "NVIDIA AIQ Enterprise Research Agent",
            "dpkName": "nvidia-aiq-enterprise-research",
            "metadata": {
              "position": { "x": 10000, "y": 10274, "z": 0 },
              "componentGroupName": "NVIDIA AIQ Enterprise Research",
              "repeatable": true,
              "pipelineNodeName": "aiq-agent-node"
            }
          },
          {
            "id": "node-research",
            "inputs": [
              {
                "portId": "port-research-in",
                "nodeId": "port-research-in",
                "type": "Item",
                "name": "item",
                "displayName": "item",
                "io": "input"
              }
            ],
            "outputs": [
              {
                "portId": "port-research-out",
                "nodeId": "port-research-out",
                "type": "Item",
                "name": "item",
                "displayName": "item",
                "io": "output"
              }
            ],
            "name": "AIQ Research",
            "type": "custom",
            "namespace": {
              "functionName": "research",
              "serviceName": "enterprise-research-compute",
              "moduleName": "enterprise-research-module",
              "packageName": "nvidia-aiq-enterprise-research"
            },
            "appName": "NVIDIA AIQ Enterprise Research Agent",
            "dpkName": "nvidia-aiq-enterprise-research",
            "metadata": {
              "position": { "x": 10400, "y": 10274, "z": 0 },
              "componentGroupName": "NVIDIA AIQ Enterprise Research",
              "repeatable": true,
              "pipelineNodeName": "aiq-research-node"
            }
          },
          {
            "id": "node-llama",
            "inputs": [
              {
                "portId": "port-llama-in",
                "nodeId": "port-llama-in",
                "type": "Item",
                "name": "item",
                "displayName": "item",
                "io": "input"
              }
            ],
            "outputs": [
              {
                "portId": "port-llama-out",
                "nodeId": "port-llama-out",
                "type": "Item",
                "name": "item",
                "displayName": "item",
                "io": "output"
              },
              {
                "portId": "port-llama-annotations",
                "nodeId": "port-llama-annotations",
                "type": "Annotation[]",
                "name": "annotations",
                "displayName": "annotations",
                "io": "output"
              }
            ],
            "name": "NIM Llama 3.3 70B - Report Writer",
            "type": "ml",
            "namespace": {
              "functionName": "predict",
              "serviceName": "",
              "moduleName": "",
              "packageName": "nim-llama-3-3-70b-instruct"
            },
            "appName": "NIM Llama 3.3 70B Instruct",
            "dpkName": "nim-llama-3-3-70b-instruct",
            "metadata": {
              "position": { "x": 10800, "y": 10274, "z": 0 },
              "modelConfig": {
                "nim_model_name": "meta/llama-3.3-70b-instruct",
                "system_prompt": "You are working with a team of research experts to deliver a publication-ready long-form report. The user provides a research topic and report organization. You also receive a research draft and sources via the provided context documents.\n\nYour task: Based on the research draft in the context, produce a comprehensive, well-structured final report.\n\nGuidelines:\n- Introduction: Begin with an engaging, context-rich introduction that frames the central questions and scope.\n- Flow & Structure: Arrange sections logically with clear headings and smooth transitions.\n- Integrated Synthesis: Blend multi-source insights into the narrative. Avoid standalone Takeaways/Insights subsections.\n- Exploratory Depth: Pursue lines of inquiry that deepen understanding.\n- Length & Form: Aim for very long reports. Write in multiple coherent paragraphs. Avoid bullet lists unless absolutely necessary.\n- Use ## for sections, ### for subsections.\n- Do NOT refer to yourself as the writer. Do not add meta-commentary.\n- Do not add a sources section (added in post-processing).\n- Do NOT wrap the report in markdown code blocks.\n- Write the report in the same language as the user's message.\n- Each section should be as long as necessary for deep analysis.\n- Return only the final report.",
                "max_tokens": 20000,
                "temperature": 0.0,
                "top_p": 0.7,
                "stream": true
              },
              "componentGroupName": "models",
              "repeatable": true,
              "variableModel": "report_writer_model",
              "pipelineNodeName": "nim-llama-70b-report-writer",
              "mlType": "genAi"
            }
          }
        ],
        "variables": [
          {
            "name": "report_writer_model",
            "type": "Model",
            "description": "LLM model for generating the final research report. Preset: NIM Llama 3.3 70B Instruct.",
            "value": "$var(report_writer_model__model)"
          },
          {
            "name": "rag_pipeline_id",
            "type": "String",
            "description": "Optional: Pipeline ID of a configured 'RAG Pipeline NVIDIA Blueprint' instance. Create a pipeline from the nim-rag-bp template, configure its dataset and models, then paste its ID here. Leave empty to skip RAG retrieval and use web search only."
          }
        ]
      }
    ]
  }
}
